var c=Object.defineProperty;var p=(r,l,o)=>l in r?c(r,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[l]=o;var n=(r,l,o)=>(p(r,typeof l!="symbol"?l+"":l,o),o);(function(r,l){typeof exports=="object"&&typeof module!="undefined"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(r=typeof globalThis!="undefined"?globalThis:r||self,l(r["wrapper-lib"]={}))})(this,function(r){"use strict";class l{constructor(t){n(this,"obsVal");n(this,"boundFrom");this.obsVal=t,this.boundFrom=[]}getVal(t){if(t==null)return this.obsVal;let i=t.split("."),e=this.obsVal;for(;i.length>1;){let s=i.shift();e=e[s]}return e[i[0]]}setVal(t,i){if(i){let e=i.split("."),s=this.obsVal;for(;e.length>1;){let h=e.shift();s=s[h]}s[e[0]]=t}else this.obsVal=t;return this.notifySubscribers(t,i),this.obsVal}notifySubscribers(t,i){this.boundFrom.forEach(e=>{e.to==this&&e.handleChange(t,i)})}}class o{constructor(t){n(this,"boundVal");n(this,"boundTo");this.boundVal=t,this.boundTo=[]}bindTo(t,i,e){let s=new d(this,t,i,e);return t.boundFrom.push(s),this.boundTo.push(s),this}getBindings(){return this.boundTo}breakBinding(t,i){return this.boundTo.forEach(e=>{e.to==t&&e.changeKey==i&&e.break()}),this}}class d{constructor(t,i,e,s){n(this,"from");n(this,"to");n(this,"changeKey");n(this,"xferFunc");this.from=t,this.to=i,this.changeKey=e,s?this.xferFunc=s:e?this.xferFunc=()=>{let h=e.split("."),a=this.to.getVal();h.forEach(b=>{a.hasOwnProperty(b)?a=a[b]:console.warn(`
                            Attempting to traverse bound path '${e}' 
                            failed at '${b}'`)}),this.from.boundVal=a}:this.xferFunc=()=>{this.from.boundVal=this.to.getVal()}}handleChange(t,i){if(i==this.changeKey){let e=this.xferFunc(t,i);e!=null&&e!=null&&(this.from.constructor.name=="Wrapper"?this.from.text(e):this.from.boundVal=e)}}break(){this.from.boundTo=this.from.boundTo.filter(t=>t!=this),this.to.boundFrom=this.to.boundFrom.filter(t=>t!=this)}}class u extends l{constructor(t,i,e){super("");n(this,"element");n(this,"parent");n(this,"children");n(this,"boundFrom");n(this,"boundTo");n(this,"boundVal");if(this.boundFrom=[],this.boundTo=[],this.children=[],i?this.element=i:this.element=document.createElement(t),this.element.tagName==="INPUT"&&this.onEvent("input",()=>{this.notifySubscribers.bind(this)(this.getVal(),"value")}),this.element.tagName==="SELECT"&&this.onEvent("change",()=>{this.notifySubscribers.bind(this)(this.getVal(),"value")}),this.element.tagName==="TEXTAREA"&&this.onEvent("input",()=>{this.notifySubscribers.bind(this)(this.getVal(),"value")}),e){if(e.i&&(this.element.id=e.i),e.n&&this.element.setAttribute("name",e.n),e.v)if(this.element.hasOwnProperty("value"))this.element.value=e.v;else throw new Error("attempted to set value on a tag that doesn't support that");e.t!=null&&(this.element.innerText=e.t),e.h!=null&&(this.element.innerHTML=e.h),e.c!=null&&this.class(e.c),e.s&&this.element.setAttribute("style",e.s),e.iT&&this.element.setAttribute("type",e.iT),e.b&&this.bindTo(e.b,void 0,s=>{this.text(s)})}}notifySubscribers(t,i){this.boundFrom.forEach(e=>{e.to==this&&e.handleChange(t,i)})}bindTo(t,i,e){e||(e=h=>{this.text(h)}),!i&&t.constructor.name=="Wrapper"&&(i="value");let s=new d(this,t,i,e);return t.boundFrom.push(s),this.boundTo.push(s),this}bindTextTo(t,i,e){return this.text(JSON.stringify(t.getVal())),typeof t.getVal()=="string"&&this.text(t.getVal()),t.constructor.name=="Wrapper"&&i=="text"&&this.text(t.getText()),t.constructor.name=="Wrapper"&&i=="style"&&this.text(t.getStyle()),this.bindTo(t,i,e)}bindStyleTo(t,i,e){return e||(e=s=>{this.style(s)}),this.bindTo(t,i,e)}bindValueTo(t,i,e){return e||(e=s=>{this.setVal(s)}),this.bindTo(t,i,e)}bindListTo(t,i){this.bindTo(t,i,e=>{this.html(""),this.listContent(e)}).listContent(t.getVal())}bindSelectTo(t,i){this.bindTo(t,i,e=>{this.html(""),this.selectContent(e)}).selectContent(t.getVal())}getBindings(){return this.boundTo}breakBinding(t,i){return this.boundTo.forEach(e=>{e.to==t&&e.changeKey==i&&e.break()}),this}static wrap(t,i){return new u(t.tagName,t,i)}newWrap(t,i,e="inside"){let s=new u(t,void 0,i);return e==="inside"&&(this.element.appendChild(s.element),this.children.push(s),s.parent=this),e==="after"&&this.element.after(s.element),e==="before"&&this.element.before(s.element),s}text(t){return this.element.innerText=t,this.notifySubscribers(t,"text"),this}attr(t,i){return this.element.setAttribute(t,i),this}html(t){return this.element.innerHTML=t,this}style(t,i){let e="";return i&&this.element.getAttribute("style")!=null&&(e=this.element.getAttribute("style").trim(),e.charAt(e.length-1)!=";"&&(e=e+"; ")),this.element.setAttribute("style",e+t),this.notifySubscribers(this.getStyle(),"style"),this}class(t){return typeof t=="string"&&(t=[t]),this.element.classList.add(t.join(" ")),this}name(t){return this.element.setAttribute("name",t),this}placehold(t){return this.element.setAttribute("placeholder",t),this}inputType(t){return this.element.setAttribute("type",t),this}kill(){this.element.remove()}killChildren(){this.children.forEach(t=>{t.kill()})}removeClass(t){return this.element.classList.remove(t),this}relocate(t,i){return i==="inside"&&t.element.appendChild(this.element),i==="before"&&t.element.before(this.element),i==="after"&&t.element.after(this.element),this}getAttr(t){return this.element.getAttribute(t)}setAttr(t,i){return this.attr(t,i)}getStyle(){let t=this.element.getAttribute("style");return t==null&&(t=""),t}setStyle(t){return this.style(t)}getText(){return this.element.innerText}setText(t){return this.text(t)}getVal(){return this.element.tagName=="INPUT"&&this.getAttr("type")=="checkbox"?this.element.checked:this.element.value}setVal(t){return this.element.value=t,this.notifySubscribers(t,"value"),this}getData(t){return this.element.dataset[t]}setData(t,i){return this.element.setAttribute("data-"+t,i),this}addWrapChild(t){return t.relocate(this,"inside"),this.children.push(t),this}addWrapBefore(t){return t.relocate(this,"before"),this}addWrapAfter(t){return t.relocate(this,"after"),this}addMultiWrap(t,i){this.style("display: grid; gap:"+i),t.forEach((e,s)=>{e.forEach((h,a)=>{h.style(`
                    ${h.getStyle()}; 
                    grid-row: ${s+1}; 
                    grid-column: ${a+1}`),h.relocate(this,"inside")})})}onEvent(t,i){return this.element.addEventListener(t,e=>i(e)),this}onClick(t){return this.onEvent("click",t),this}onInput(t){return this.onEvent("input",t),this}onChange(t){return this.onEvent("change",t),this}onEnterKey(t){return this.element.addEventListener("keyup",function(i){i.code==="Enter"&&(i.preventDefault(),t(i))}),this}listContent(t,i){if(this.element.tagName!="UL"&&this.element.tagName!="OL")throw console.error(`The Wrapper instance from which listContent was called is not 
            wrapped around a 'ul' or 'ol' element. It's a ${this.element}`),new Error('List Content must be appended to a "ul" or "ol"');if(this.killChildren(),i){if(t.length!=i.length)throw console.error({"not the same length":t,as:i}),new Error("textList and idList not the same length");t.forEach((e,s)=>{this.newWrap("li",{i:i[s]}).text(e)})}else t.forEach(e=>{this.newWrap("li").text(e)});return this}selectContent(t,i,e){if(i||(i=t),t.length!=i.length)throw console.error({"not the same length":t,as:i}),new Error("textList and idList not the same length");if(e){if(t.length!=e.length)throw console.error({"not the same length":t,as:e}),new Error("textList and idList not the same length");t.forEach((s,h)=>{this.newWrap("option",{i:e[h]}).text(s).setVal(i[h])})}else t.forEach((s,h)=>{this.newWrap("option").text(s).setVal(i[h])});return this}makeLabeledInput(t,i,e,s){let h=this.newWrap("div",void 0,e);return i=i===void 0?"input":i,e=e===void 0?"inside":e,new m(h.element,t,i,s)}}class m extends u{constructor(t,i,e="input",s){super("div",t);n(this,"container");n(this,"label");n(this,"input");this.container=this.element,this.style("display:flex"),i===void 0&&(i=Math.random().toString(36).slice(6)),this.label=this.newWrap("label").attr("for",i).text("Input"),this.input=this.newWrap(e,{i}),s&&(s.contStyle&&this.style(s.contStyle),s.inputStyle&&this.input.style(s.inputStyle),s.lblStyle&&this.label.style(s.lblStyle),s.lbl&&this.label.text(s.lbl),s.placehold&&this.input.placehold(s.placehold),s.default&&this.input.setVal(s.default),s.inputType&&this.input.attr("type",s.inputType),s.stacked&&!s.contStyle&&!s.inputStyle&&(this.style("display:block"),this.input.style("width: 100%; display: block")))}}r.Binding=d,r.Observable=l,r.Observer=o,r.WrappedInputLabelPair=m,r.Wrapper=u,Object.defineProperty(r,"__esModule",{value:!0}),r[Symbol.toStringTag]="Module"});
